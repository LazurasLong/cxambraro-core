var world=$(".world"),sprite=$(".world__sprite"),output=$(".output"),controls=$(".controls"),panel=$(".panel"),next=$("#next"),counter=0,story;
class SSTA{static setBg(a){a=a.split(""),a.splice(0,2),a=a.join(""),world.css("background-image",`url(img/bg/${a}.png)`),counter++,this.parse(story[counter])}static setBg2(a){a=a.split(""),a.splice(0,3),a=a.join(""),$("body").css("background-image",`url(img/bg/${a}.png)`),counter++,this.parse(story[counter])}static setSprite(a){a=a.split(""),a.splice(0,1),a=a.join(""),sprite.attr("src",`img/sprite/${a}.png`),counter++,this.parse(story[counter])}static listen(subj){subj=subj.split(""),subj.splice(0,1),subj=subj.join("").split("_"),eval(`${subj[0]}.listen("${subj[1]}")`),counter++}static say(a){output.append(`<p class="from-me animated tdExpandIn">← ${a}</p>`)}static runCode(subj){subj=subj.split(""),subj.splice(0,2),subj=subj.join(""),eval(subj),counter++}static setStoryCounter(subj){subj=subj.split(""),subj.splice(0,1),subj=subj.join("").split(":"),eval(`story = ${subj[0]}; counter = ${subj[1]}`),this.parse(story[counter])}static sendResponses(a){controls.html("");for(let b=0;b<a.length;b++){let c=a[b].split("--");controls.append(`<button onclick="SSTA.response('${c[0]}', '${c[1]}')"class="controls__button animated tdExpandIn">${c[0]}</button>`)}}static response(a,b){this.say(a),this.setStoryCounter(`:${b}:0`),controls.html("&nbsp;"),this.parse(story[counter])}static parse(a){"string"==typeof a?"_"===a.charAt(0)?"_"===a.charAt(2)?this.setBg2(a):"_"===a.charAt(1)?this.setBg(a):this.listen(a):":"===a.charAt(0)?":"===a.charAt(1)?this.runCode(a):this.setStoryCounter(a):";"===a.charAt(0)&&this.setSprite(a):Array.isArray(a)?this.sendResponses(a):this.say(a)}}
class Character{constructor(name,color){this.name=name;this.color=color}listen(text){output.append(`<p class="to-me animated tdExpandIn">→ <span style="color:${this.color}">${this.name}</span>: ${text}</p>`)}}
$("#btn_save").on("click",()=>{alert("Your game wasn't actually saved...")});$("#btn_info").on("click",()=>{alert("Ĉambraro SHOVEL by @bouncepaw (gh, tg, insta)")})
next.on("click",()=>{SSTA.parse(story[counter])});SSTA.parse(story[counter])
